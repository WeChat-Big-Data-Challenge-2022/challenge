## 初赛代码提交规范说明
初赛结束后，B榜TOP150团队需提交代码审核。组委会将审核并取消存在人工标注、相互抄袭等行为队伍的比赛资格，晋级空缺名额后补。对于初赛成绩符合要求且通过实名认证的参赛队伍，排名前100名的参赛队伍将进入复赛，所有通过审核的队伍将获得初赛名次证书。具体代码提交要求如下：

### 1. 截止时间
北京时间2022年6月26日中午12:00，逾期未提交的队伍将取消复赛资格

### 2. 提交方法
将代码整理为本文档要求的目录结构，提交到 https://code.tencent.com 上, 将提交代码仓库设置为私有，添加 Wechat-Big-Data-Challenge-2022 用户到项目成员中，并赋予 Developer 权限。

### 3. 项目命名格式
wbdc2022-preliminary-队伍ID

注：队伍ID在大赛小程序主页和网站个人中心都可以找到。

### 4. 目录结构

目录结构如下，其中`data/`仅展示格式，选手在提交时，该目录可为空。即选手无需提交任何数据、特征、模型、结果文件。
```
./
├── README.md
├── requirements.txt      # Python包依赖文件 
├── init.sh               # 初始化脚本，用于准备环境
├── train.sh              # 模型训练脚本
├── inference.sh          # 模型测试脚本 
├── src/                  # 核心代码
├── data/
│   ├── annotations/      # 数据集标注（仅作示意，无需上传）
│   ├── zip_feats/        # 数据集视觉特征（仅作示意，无需上传）
```

### 5. 具体说明

1. README文件  
需包含环境依赖（包括python版本、CUDA版本、操作系统等环境信息)、代码结构、运行流程说明、算法模型介绍、模型初赛B榜离线/在线结果等内容。
如使用了开源的预训练模型（例如 huggingface 上的模型），请在 README 文件中进行说明，并附上开源模型的链接。

2. 环境配置文件  
运行`bash init.sh`设置运行环境，例如安装需要的 python 包、某些自定义模块的编译（如有）、数据预处理
  ```bash
├── requirements.txt      # Python包依赖文件 
├── init.sh               # 初始化脚本，用于准备环境
  ```

3. 训练和预测脚本  
请确保对初赛B榜测试集的预测结果可以由提交的训练、预测脚本产出。
  ```bash
├── train.sh              # 模型训练脚本
├── inference.sh          # 模型测试脚本 
  ```

  如果训练过程中包含多个步骤（如预训练、模型融合等），请按顺序写在脚本中，例如
  ```bash
python src/pretrain.py      # 预训练
python src/main.py --seed 0 # 微调权重1
python src/main.py --seed 1 # 微调权重2
  ```

4. 核心代码目录`src/`  
选手需要在此文件夹中存放所有核心代码文件，包括数据预处理、预训练、模型训练和预测等。

  Tips：
  * 提交的核心代码中，具体的文件、目录名可自行命名
  * 如果代码中包含开源的第三方代码文件，请统一放在`src/third_party/`目录下；能通过`init.sh`安装的第三方库不需要额外放在该目录下
  * 训练阶段需保存预测阶段所需的模型文件

5. 数据目录`data/`  
这里只是展示`data`目录的要求，选手在提交时，该目录可为空。即选手无需提交任何数据、特征、模型文件。
  * `zip_feats/`, `annotations/` 目录存放比赛数据集，无需上传。
  * 选手的其他数据（如有）可以存放在`data/`目录下的其他文件目录中，不做限制
  ```bash
├── data/
│   ├── annotations/
│   ├── zip_feats/
  ```

### 6. 复现说明
1. 组委会将抽取部分选手的代码进行复现。组委会将依次执行init.sh, train.sh, inference.sh这三个脚本，选手需确保代码执行后生成的B榜测试集的预测结果文件命名为`result.csv`并保存在`data/`目录下。
2. 复现结果的评测分数与队伍B榜最终分数需在一定误差范围内保持一致（+- 0.005）。
3. 复现过程中若出现任何问题（例如：运行失败或复现结果不一致），组委会将联系选手进行确认。

### 7. 附录
* 官方baseline已整理为本文档要求的格式供大家参考：https://github.com/WeChat-Big-Data-Challenge-2022/challenge/tree/preliminary_submission

### 8. FAQ
1. 代码运行是否有要求？
  * 有要求：组委会将依次执行init.sh, train.sh, inference.sh这三个脚本，选手需确保代码执行后生成的B榜测试集的预测结果文件命名为result.csv并保存在`data/`目录下。

2. 比赛数据集或者中间生成的模型、特征、数据文件是否需要提交？
  * 都不需要。如果选手使用了开源的预训练模型，组委会在复现时将联系选手提供。

3. 代码是否会进行相似度检测？
  * 为防止开小号等违规情况，保证比赛的公平性，将对提交的代码进行相似度检测。

4. 同一队伍内多个选手的代码能否分别放在不同的目录下？
  * 可以。但需要统一放在src目录下。并且需要提供统一的init.sh, train.sh, inference.sh

5. 初赛数据集是放在哪个目录下？
  * 组委会在复现时，会将初赛数据集放在`data/`目录下，得到如下的目录结构:
  ```
├── data/
    ├── annotations
    │   ├── labeled.json
    │   ├── test_b.json
    │   └── unlabeled.json
    ├── README.md
    ├── verify_data.py
    └── zip_feats
        ├── labeled.zip
        ├── test_b.zip
        └── unlabeled.zip
  ```

6. 训练阶段是否需要把模型保存下来？
  * 需要。训练阶段（train.sh）保存模型，预测阶段（inference.sh）加载模型进行预测
